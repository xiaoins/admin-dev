# 电商后台管理系统 - 启动说明

## ✅ 项目构建状态

- **编译状态**：✅ 成功
- **打包状态**：✅ 成功
- **生成文件**：`target/admin-0.0.1-SNAPSHOT.jar` (约 64MB)

## 📋 启动前准备

### 1. 环境要求

- ✅ JDK 21
- ⚠️ MySQL 8.0+ （需要启动）
- ⚠️ Redis 6.0+ （需要启动）

### 2. 创建数据库

```sql
CREATE DATABASE mall_admin CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 3. 配置文件

修改 `src/main/resources/application-dev.yml`：

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/mall_admin?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false
    username: root
    password: 你的MySQL密码
    
  data:
    redis:
      host: localhost
      port: 6379
      password: 你的Redis密码（如果有）
```

## 🚀 启动方式

### 方式一：Maven 启动（开发环境推荐）

```bash
cd H:\code\backend\admin
mvn spring-boot:run
```

### 方式二：直接运行 JAR 包（生产环境）

```bash
cd H:\code\backend\admin
java -jar target/admin-0.0.1-SNAPSHOT.jar
```

### 方式三：指定环境启动

```bash
# 开发环境
java -jar target/admin-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev

# 生产环境
java -jar target/admin-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod
```

## 📊 验证启动

启动成功后，访问以下地址：

1. **API 文档**：http://localhost:8080/api/admin/v1/doc.html
2. **健康检查**：http://localhost:8080/api/admin/v1/actuator/health
3. **Swagger JSON**：http://localhost:8080/api/admin/v1/v3/api-docs

## 🔐 测试登录

### 使用 API 文档测试

1. 访问：http://localhost:8080/api/admin/v1/doc.html
2. 找到 "认证管理" -> "用户登录" 接口
3. 点击 "调试"
4. 输入以下信息：
   ```json
   {
     "username": "admin",
     "password": "admin123"
   }
   ```
5. 点击 "发送"
6. 获取返回的 token
7. 点击右上角 "Authorize"，输入：`Bearer {你的token}`
8. 现在可以测试其他需要认证的接口

### 使用 curl 测试

```bash
# 登录获取 token
curl -X POST "http://localhost:8080/api/admin/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'

# 使用 token 访问受保护的接口
curl -X GET "http://localhost:8080/api/admin/v1/categories/tree" \
  -H "Authorization: Bearer {你的token}"
```

## 📝 默认账号

| 用户名 | 密码 | 角色 | 说明 |
|--------|------|------|------|
| admin | admin123 | 超级管理员 | 拥有所有权限 |
| operator | admin123 | 运营管理员 | 商品、订单、营销管理 |
| analyst | admin123 | 数据分析员 | 仅查看数据统计 |

## ⚠️ 常见问题

### 1. 数据库连接失败

**错误信息**：`Communications link failure`

**解决方案**：
- 检查 MySQL 服务是否启动
- 检查数据库地址、端口、用户名、密码是否正确
- 检查数据库 `mall_admin` 是否已创建

### 2. Redis 连接失败

**错误信息**：`Unable to connect to Redis`

**解决方案**：
- 检查 Redis 服务是否启动
- 检查 Redis 地址、端口是否正确
- 如果设置了密码，检查密码是否正确

### 3. 端口被占用

**错误信息**：`Port 8080 is already in use`

**解决方案**：
修改 `application.yml` 中的端口：
```yaml
server:
  port: 8081  # 改成其他端口
```

### 4. Flyway 迁移失败

**错误信息**：`FlywayException: Validate failed`

**解决方案**：
- 清空数据库后重新启动
- 或者禁用 Flyway 验证：`spring.flyway.validate-on-migrate=false`

## 🎯 启动成功标志

看到以下输出表示启动成功：

```
========================================
电商后台管理系统启动成功！
API文档地址: http://localhost:8080/api/admin/v1/doc.html
========================================
```

## 📚 项目文档

- **README.md**：项目总体介绍
- **启动说明.md**：本文档
- **后端开发计划设计.md**：开发计划
- **需求规格文档说明书.md**：需求文档

## 🛠️ 开发调试

### 启用调试日志

修改 `application-dev.yml`：

```yaml
logging:
  level:
    root: DEBUG
    com.xiaoins.admin: DEBUG
    com.baomidou.mybatisplus: DEBUG
```

### 查看 SQL 日志

MyBatis-Plus 已配置为输出 SQL 日志（开发环境）

### 关闭 Flyway

如果不需要自动执行数据库迁移：

```yaml
spring:
  flyway:
    enabled: false
```

---

**项目状态**：✅ 编译通过，可以正常启动（需要配置数据库和Redis）

