# ç”¨æˆ·ç®¡ç†æ¨¡å— API æµ‹è¯•æŒ‡å—

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

ç”¨æˆ·ç®¡ç†æ¨¡å—æä¾›äº†å®Œæ•´çš„ç”¨æˆ·CRUDæ“ä½œï¼ŒåŒ…æ‹¬ï¼š
- âœ… åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
- âœ… æŸ¥è¯¢ç”¨æˆ·è¯¦æƒ…
- âœ… åˆ›å»ºç”¨æˆ·
- âœ… æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- âœ… åˆ é™¤ç”¨æˆ·
- âœ… å¯ç”¨/ç¦ç”¨ç”¨æˆ·
- âœ… é‡ç½®ç”¨æˆ·å¯†ç 

---

## ğŸš€ å¼€å§‹æµ‹è¯•

### å‰ç½®æ¡ä»¶

1. **åç«¯å·²å¯åŠ¨**
   ```bash
   cd admin
   mvn spring-boot:run
   ```

2. **è·å–è®¿é—®ä»¤ç‰Œ**

è®¿é—®ï¼šhttp://localhost:8080/api/admin/v1/doc.html

å…ˆè°ƒç”¨ **è®¤è¯æ¨¡å— â†’ ç”¨æˆ·ç™»å½•** è·å– Tokenï¼š

**è¯·æ±‚ï¼š**
```json
{
  "username": "admin",
  "password": "admin123"
}
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiJ9...",
    "tokenType": "Bearer",
    "expiresIn": 604800
  }
}
```

3. **è®¾ç½® Authorization Header**

åœ¨åç»­æ‰€æœ‰è¯·æ±‚ä¸­ï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´æ·»åŠ ï¼š
```
Authorization: Bearer {token}
```

---

## ğŸ“ API æµ‹è¯•ç”¨ä¾‹

### 1. åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨

**æ¥å£ï¼š** `GET /api/admin/v1/users/page`

**è¯·æ±‚å‚æ•°ï¼š**
```
username=ï¼ˆå¯é€‰ï¼‰ç”¨æˆ·åï¼Œæ¨¡ç³ŠæŸ¥è¯¢
realName=ï¼ˆå¯é€‰ï¼‰çœŸå®å§“åï¼Œæ¨¡ç³ŠæŸ¥è¯¢
phone=ï¼ˆå¯é€‰ï¼‰æ‰‹æœºå·
roleId=ï¼ˆå¯é€‰ï¼‰è§’è‰²ID
status=ï¼ˆå¯é€‰ï¼‰çŠ¶æ€ï¼ˆ0ç¦ç”¨ 1å¯ç”¨ï¼‰
pageNum=1ï¼ˆå½“å‰é¡µç ï¼‰
pageSize=10ï¼ˆæ¯é¡µå¤§å°ï¼‰
```

**æµ‹è¯•ç”¨ä¾‹ 1.1ï¼šæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·**
```
GET /api/admin/v1/users/page?pageNum=1&pageSize=10
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "records": [
      {
        "userId": 1,
        "username": "admin",
        "realName": "ç³»ç»Ÿç®¡ç†å‘˜",
        "phone": "13800138000",
        "email": "admin@example.com",
        "roleId": 1,
        "roleName": "è¶…çº§ç®¡ç†å‘˜",
        "status": 1,
        "statusDesc": "å¯ç”¨",
        "createTime": "2025-10-05 16:42:17",
        "updateTime": "2025-10-05 16:44:46"
      }
    ],
    "total": 3,
    "size": 10,
    "current": 1
  }
}
```

**æµ‹è¯•ç”¨ä¾‹ 1.2ï¼šæŒ‰ç”¨æˆ·åæ¨¡ç³ŠæŸ¥è¯¢**
```
GET /api/admin/v1/users/page?username=admin&pageNum=1&pageSize=10
```

**æµ‹è¯•ç”¨ä¾‹ 1.3ï¼šæŒ‰è§’è‰²æŸ¥è¯¢**
```
GET /api/admin/v1/users/page?roleId=1&pageNum=1&pageSize=10
```

**æµ‹è¯•ç”¨ä¾‹ 1.4ï¼šæŸ¥è¯¢ç¦ç”¨çš„ç”¨æˆ·**
```
GET /api/admin/v1/users/page?status=0&pageNum=1&pageSize=10
```

---

### 2. æŸ¥è¯¢ç”¨æˆ·è¯¦æƒ…

**æ¥å£ï¼š** `GET /api/admin/v1/users/{userId}`

**æµ‹è¯•ç”¨ä¾‹ 2.1ï¼šæŸ¥è¯¢adminç”¨æˆ·è¯¦æƒ…**
```
GET /api/admin/v1/users/1
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "userId": 1,
    "username": "admin",
    "realName": "ç³»ç»Ÿç®¡ç†å‘˜",
    "phone": "13800138000",
    "email": "admin@example.com",
    "roleId": 1,
    "roleName": "è¶…çº§ç®¡ç†å‘˜",
    "status": 1,
    "statusDesc": "å¯ç”¨",
    "createTime": "2025-10-05 16:42:17",
    "updateTime": "2025-10-05 16:44:46"
  }
}
```

**æµ‹è¯•ç”¨ä¾‹ 2.2ï¼šæŸ¥è¯¢ä¸å­˜åœ¨çš„ç”¨æˆ·**
```
GET /api/admin/v1/users/999
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0004",
  "message": "æ•°æ®ä¸å­˜åœ¨"
}
```

---

### 3. åˆ›å»ºç”¨æˆ·

**æ¥å£ï¼š** `POST /api/admin/v1/users`

**æµ‹è¯•ç”¨ä¾‹ 3.1ï¼šåˆ›å»ºæ­£å¸¸ç”¨æˆ·**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "test001",
  "password": "123456",
  "realName": "æµ‹è¯•ç”¨æˆ·001",
  "phone": "13900139001",
  "email": "test001@example.com",
  "roleId": 2,
  "status": 1
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": 4
}
```

**æµ‹è¯•ç”¨ä¾‹ 3.2ï¼šåˆ›å»ºé‡å¤ç”¨æˆ·å**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "admin",
  "password": "123456",
  "realName": "æµ‹è¯•",
  "phone": "13900139002",
  "email": "test@example.com",
  "roleId": 2,
  "status": 1
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0001",
  "message": "ç”¨æˆ·åå·²å­˜åœ¨"
}
```

**æµ‹è¯•ç”¨ä¾‹ 3.3ï¼šåˆ›å»ºæ—¶æ‰‹æœºå·é‡å¤**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "test002",
  "password": "123456",
  "realName": "æµ‹è¯•",
  "phone": "13800138000",
  "email": "test002@example.com",
  "roleId": 2,
  "status": 1
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0001",
  "message": "æ‰‹æœºå·å·²è¢«ä½¿ç”¨"
}
```

**æµ‹è¯•ç”¨ä¾‹ 3.4ï¼šå‚æ•°æ ¡éªŒ-ç”¨æˆ·åæ ¼å¼é”™è¯¯**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "ab",
  "password": "123456",
  "realName": "æµ‹è¯•",
  "roleId": 2
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0002",
  "message": "ç”¨æˆ·åå¿…é¡»æ˜¯4-20ä½å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿"
}
```

**æµ‹è¯•ç”¨ä¾‹ 3.5ï¼šå‚æ•°æ ¡éªŒ-å¯†ç å¤ªçŸ­**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "test003",
  "password": "123",
  "realName": "æµ‹è¯•",
  "roleId": 2
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0002",
  "message": "å¯†ç é•¿åº¦å¿…é¡»åœ¨6-20ä½ä¹‹é—´"
}
```

---

### 4. æ›´æ–°ç”¨æˆ·

**æ¥å£ï¼š** `PUT /api/admin/v1/users`

**æµ‹è¯•ç”¨ä¾‹ 4.1ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "userId": 4,
  "realName": "æµ‹è¯•ç”¨æˆ·001ï¼ˆå·²ä¿®æ”¹ï¼‰",
  "phone": "13900139009",
  "email": "test001_new@example.com",
  "roleId": 3,
  "status": 1
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": true
}
```

**æµ‹è¯•ç”¨ä¾‹ 4.2ï¼šæ›´æ–°ä¸å­˜åœ¨çš„ç”¨æˆ·**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "userId": 999,
  "realName": "æµ‹è¯•",
  "roleId": 2,
  "status": 1
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0004",
  "message": "æ•°æ®ä¸å­˜åœ¨"
}
```

---

### 5. åˆ é™¤ç”¨æˆ·

**æ¥å£ï¼š** `DELETE /api/admin/v1/users/{userId}`

**æµ‹è¯•ç”¨ä¾‹ 5.1ï¼šåˆ é™¤æ™®é€šç”¨æˆ·**
```
DELETE /api/admin/v1/users/4
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": true
}
```

**æµ‹è¯•ç”¨ä¾‹ 5.2ï¼šåˆ é™¤adminç”¨æˆ·ï¼ˆåº”è¯¥è¢«æ‹’ç»ï¼‰**
```
DELETE /api/admin/v1/users/1
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0001",
  "message": "ä¸èƒ½åˆ é™¤ç³»ç»Ÿç®¡ç†å‘˜"
}
```

**æµ‹è¯•ç”¨ä¾‹ 5.3ï¼šåˆ é™¤ä¸å­˜åœ¨çš„ç”¨æˆ·**
```
DELETE /api/admin/v1/users/999
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0004",
  "message": "æ•°æ®ä¸å­˜åœ¨"
}
```

---

### 6. å¯ç”¨/ç¦ç”¨ç”¨æˆ·

**æ¥å£ï¼š** `PUT /api/admin/v1/users/{userId}/status/{status}`

**æµ‹è¯•ç”¨ä¾‹ 6.1ï¼šç¦ç”¨ç”¨æˆ·**
```
PUT /api/admin/v1/users/2/status/0
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": true
}
```

**æµ‹è¯•ç”¨ä¾‹ 6.2ï¼šå¯ç”¨ç”¨æˆ·**
```
PUT /api/admin/v1/users/2/status/1
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": true
}
```

**æµ‹è¯•ç”¨ä¾‹ 6.3ï¼šç¦ç”¨adminç”¨æˆ·ï¼ˆåº”è¯¥è¢«æ‹’ç»ï¼‰**
```
PUT /api/admin/v1/users/1/status/0
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0001",
  "message": "ä¸èƒ½ç¦ç”¨ç³»ç»Ÿç®¡ç†å‘˜"
}
```

---

### 7. é‡ç½®ç”¨æˆ·å¯†ç 

**æ¥å£ï¼š** `PUT /api/admin/v1/users/reset-password`

**æµ‹è¯•ç”¨ä¾‹ 7.1ï¼šé‡ç½®å¯†ç **

**è¯·æ±‚ä½“ï¼š**
```json
{
  "userId": 2,
  "newPassword": "newpass123"
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": true
}
```

**éªŒè¯ï¼š** é€€å‡ºç™»å½•åï¼Œä½¿ç”¨æ–°å¯†ç  `newpass123` ç™»å½• `operator` ç”¨æˆ·ï¼Œåº”è¯¥æˆåŠŸã€‚

**æµ‹è¯•ç”¨ä¾‹ 7.2ï¼šé‡ç½®ä¸å­˜åœ¨ç”¨æˆ·çš„å¯†ç **

**è¯·æ±‚ä½“ï¼š**
```json
{
  "userId": 999,
  "newPassword": "123456"
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0004",
  "message": "æ•°æ®ä¸å­˜åœ¨"
}
```

**æµ‹è¯•ç”¨ä¾‹ 7.3ï¼šå¯†ç æ ¼å¼æ ¡éªŒ**

**è¯·æ±‚ä½“ï¼š**
```json
{
  "userId": 2,
  "newPassword": "123"
}
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "code": "A0002",
  "message": "å¯†ç é•¿åº¦å¿…é¡»åœ¨6-20ä½ä¹‹é—´"
}
```

---

## ğŸ§ª å®Œæ•´æµ‹è¯•æµç¨‹

### æ­¥éª¤ 1ï¼šç™»å½•è·å–Token
```
POST /api/admin/v1/auth/login
{
  "username": "admin",
  "password": "admin123"
}
```

### æ­¥éª¤ 2ï¼šæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
```
GET /api/admin/v1/users/page?pageNum=1&pageSize=10
```

### æ­¥éª¤ 3ï¼šåˆ›å»ºæ–°ç”¨æˆ·
```
POST /api/admin/v1/users
{
  "username": "testuser",
  "password": "test123",
  "realName": "æµ‹è¯•ç”¨æˆ·",
  "phone": "13900139999",
  "email": "testuser@example.com",
  "roleId": 2,
  "status": 1
}
```

### æ­¥éª¤ 4ï¼šæŸ¥è¯¢æ–°ç”¨æˆ·è¯¦æƒ…
```
GET /api/admin/v1/users/{è¿”å›çš„userId}
```

### æ­¥éª¤ 5ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯
```
PUT /api/admin/v1/users
{
  "userId": {åˆšåˆ›å»ºçš„userId},
  "realName": "æµ‹è¯•ç”¨æˆ·ï¼ˆå·²ä¿®æ”¹ï¼‰",
  "phone": "13900139999",
  "email": "testuser@example.com",
  "roleId": 3,
  "status": 1
}
```

### æ­¥éª¤ 6ï¼šç¦ç”¨ç”¨æˆ·
```
PUT /api/admin/v1/users/{userId}/status/0
```

### æ­¥éª¤ 7ï¼šå¯ç”¨ç”¨æˆ·
```
PUT /api/admin/v1/users/{userId}/status/1
```

### æ­¥éª¤ 8ï¼šé‡ç½®å¯†ç 
```
PUT /api/admin/v1/users/reset-password
{
  "userId": {userId},
  "newPassword": "newpass123"
}
```

### æ­¥éª¤ 9ï¼šåˆ é™¤ç”¨æˆ·
```
DELETE /api/admin/v1/users/{userId}
```

### æ­¥éª¤ 10ï¼šéªŒè¯åˆ é™¤æˆåŠŸ
```
GET /api/admin/v1/users/{userId}
// åº”è¯¥è¿”å› "æ•°æ®ä¸å­˜åœ¨"
```

---

## ğŸ”’ æƒé™è¯´æ˜

æ‰€æœ‰ç”¨æˆ·ç®¡ç†æ¥å£éƒ½éœ€è¦ï¼š
1. **è®¤è¯ï¼š** å¿…é¡»æºå¸¦æœ‰æ•ˆçš„ JWT Token
2. **æˆæƒï¼š** éœ€è¦æœ‰ç›¸åº”çš„æƒé™ï¼ˆåç»­ä¼šå®ç°RBACï¼‰

å½“å‰é˜¶æ®µï¼Œåªè¦æ˜¯ç™»å½•ç”¨æˆ·å°±å¯ä»¥è®¿é—®è¿™äº›æ¥å£ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç³»ç»Ÿä¿æŠ¤
- âŒ **ä¸èƒ½åˆ é™¤** admin ç”¨æˆ·
- âŒ **ä¸èƒ½ç¦ç”¨** admin ç”¨æˆ·

### 2. æ•°æ®æ ¡éªŒ
- ç”¨æˆ·åï¼š4-20ä½å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿
- å¯†ç ï¼š6-20ä½ä»»æ„å­—ç¬¦
- æ‰‹æœºå·ï¼š11ä½ä¸­å›½å¤§é™†æ‰‹æœºå·
- é‚®ç®±ï¼šæ ‡å‡†é‚®ç®±æ ¼å¼

### 3. å”¯ä¸€æ€§çº¦æŸ
- ç”¨æˆ·åï¼šå…¨å±€å”¯ä¸€
- æ‰‹æœºå·ï¼šå…¨å±€å”¯ä¸€ï¼ˆå¦‚æœæä¾›ï¼‰

### 4. å¯†ç å®‰å…¨
- å¯†ç ä½¿ç”¨ BCrypt åŠ å¯†å­˜å‚¨
- å¯†ç å­—æ®µä¸ä¼šåœ¨æŸ¥è¯¢æ¥å£ä¸­è¿”å›
- é‡ç½®å¯†ç åï¼Œæ—§å¯†ç ç«‹å³å¤±æ•ˆ

---

## ğŸ“Š æ•°æ®åº“æŸ¥è¯¢éªŒè¯

å¦‚æœéœ€è¦åœ¨æ•°æ®åº“ä¸­éªŒè¯æ•°æ®ï¼š

```sql
-- æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
SELECT 
    user_id, username, real_name, phone, email, 
    role_id, status, create_time, update_time
FROM sys_user;

-- æŸ¥è¯¢ç”¨æˆ·åŠå…¶è§’è‰²
SELECT 
    u.user_id, u.username, u.real_name, u.status,
    r.role_name
FROM sys_user u
LEFT JOIN sys_role r ON u.role_id = r.role_id;

-- æ£€æŸ¥å¯†ç é•¿åº¦ï¼ˆåº”è¯¥æ˜¯60ï¼‰
SELECT username, LENGTH(password) as pwd_length
FROM sys_user;
```

---

## ğŸ“ æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] ç”¨æˆ·åˆ—è¡¨åˆ†é¡µæŸ¥è¯¢æ­£å¸¸
- [ ] å„ç§ç­›é€‰æ¡ä»¶ç”Ÿæ•ˆ
- [ ] ç”¨æˆ·è¯¦æƒ…æŸ¥è¯¢æ­£å¸¸
- [ ] åˆ›å»ºç”¨æˆ·æˆåŠŸ
- [ ] ç”¨æˆ·åé‡å¤æ£€æµ‹ç”Ÿæ•ˆ
- [ ] æ‰‹æœºå·é‡å¤æ£€æµ‹ç”Ÿæ•ˆ
- [ ] å‚æ•°æ ¡éªŒæ­£å¸¸å·¥ä½œ
- [ ] æ›´æ–°ç”¨æˆ·ä¿¡æ¯æˆåŠŸ
- [ ] åˆ é™¤ç”¨æˆ·æˆåŠŸ
- [ ] ä¸èƒ½åˆ é™¤adminç”¨æˆ·
- [ ] å¯ç”¨/ç¦ç”¨ç”¨æˆ·æˆåŠŸ
- [ ] ä¸èƒ½ç¦ç”¨adminç”¨æˆ·
- [ ] é‡ç½®å¯†ç æˆåŠŸ
- [ ] æ–°å¯†ç èƒ½æ­£å¸¸ç™»å½•

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š2025-10-06**  
**æ¨¡å—çŠ¶æ€ï¼šâœ… å¼€å‘å®Œæˆï¼Œå¾…æµ‹è¯•**

